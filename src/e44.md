<html><iframe src="https://docs.google.com/presentation/d/e/2PACX-1vSMZszzJpj30CKt2_noc6bBnew7m4JwxujysybKLAZZCXPHOrC2TrXZ43M8Sfe22cKYmemgq9KLE1UV/embed?start=false&loop=false&delayms=60000" frameborder="0" width="750" height="460" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe></html>

<html>
<button class="accordion" onclick="toggle('the-accordion');">Problem / 問</button>
<div id="the-accordion" class="panel w3-hide">
Problem 44 "Pentagon numbers"

<p>Pentagonal numbers are generated by the formula, P<sub><var>n</var></sub>=<var>n</var>(3<var>n</var>−1)/2. The first ten pentagonal numbers are:</p>
<p class="center">1, 5, 12, 22, 35, 51, 70, 92, 117, 145, ...</p>
<p>It can be seen that P<sub>4</sub> + P<sub>7</sub> = 22 + 70 = 92 = P<sub>8</sub>. However, their difference, 70 − 22 = 48, is not pentagonal.</p>
<p>Find the pair of pentagonal numbers, P<sub><var>j</var></sub> and P<sub><var>k</var></sub>, for which their sum and difference are pentagonal and D = |P<sub><var>k</var></sub> − P<sub><var>j</var></sub>| is minimised; what is the value of D?</p>


問 44 「五角数」


五角数は \\(P_{n} = n(3n-1)/2 \\) で生成される. 最初の10項は

1, 5, 12, 22, 35, 51, 70, 92, 117, 145, ...

である.

\\( P_{4} + P_{7} = 22 + 70 = 92 = P_{8} \\) である. しかし差 70 - 22 = 48 は五角数ではない.

五角数のペア \\( P_{j} \\) と \\( P_{k} \\) について, 差と和が五角数になるものを考える. 差を D = \\( |P_{k} - P_{j}| \\) と書く. 差 D の最小値を求めよ.

</div>
</html>


- [Q.42 Coded triangle numbers](./e42.md)

```rust,editable
fn is_pentagonal(n: u64) -> bool {
    let expr = 24 * n + 1;
    let sqrt = (expr as f64).sqrt() as u64;
    if expr != sqrt * sqrt {
        return false;
    }
    sqrt % 6 == 5
}

fn pentagon(n: u64) -> u64 {
    n * (3 * n - 1) / 2
}

fn calc_distance(pentagons: &mut Vec<u64>) -> (u64, u64) {
    for n in 1u64.. {
        let p1 = pentagon(n);
        for &p2 in pentagons.iter().rev() {
            let d = p1 - p2;
            let s = p1 + p2;
            if is_pentagonal(d) && is_pentagonal(s) {
                return (d, n);
            }
        }
        pentagons.push(p1);
    }
    unreachable!("This function is supposed to have return but not break in the outermost loop!");
}

fn is_answer_confirmed(pentagons: &mut Vec<u64>, distance: u64, nth: u64) -> bool {
    pentagons.push(pentagon(nth));
    for n in nth + 1.. {
        let p1 = pentagon(n);
        if 3 * (n - 1) + 1 > distance {
            return true;
        }
        for &p2 in pentagons.iter().rev() {
            let d = p1 - p2;
            if d >= distance {
                break;
            }
            let s = p1 + p2;
            if is_pentagonal(d) && is_pentagonal(s) {
                return false;
            }
        }
        pentagons.push(p1);
    }
    unreachable!("This function is supposed to have return but not break in the outermost loop!");
}

fn main() {
    let mut pentagons = vec![];
    let (d, nth) = calc_distance(&mut pentagons);
    assert!(is_answer_confirmed(&mut pentagons, d, nth));

    println!("{}", d);
    assert_eq!(d, 5482660);
}
```
