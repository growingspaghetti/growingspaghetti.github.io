<html><iframe src="https://docs.google.com/presentation/d/e/2PACX-1vSaHP7TcUI71uiwljBVfn6M7yFRxgXos451Bcb_q-y0h__0CLFzDZn916HYRaj-y_hfgcS-MUbDsEh6/embed?start=false&loop=false&delayms=60000" frameborder="0"  width="750" height="460" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe></html>

<html>
<button class="accordion" onclick="toggle('the-accordion');">Problem / 問</button>
<div id="the-accordion" class="panel w3-hide">
Problem 2 "Even Fibonacci numbers"

<p>Each new term in the Fibonacci sequence is generated by adding the previous two terms. By starting with 1 and 2, the first 10 terms will be:</p>
<p class="center">1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ...</p>
<p>By considering the terms in the Fibonacci sequence whose values do not exceed four million, find the sum of the even-valued terms.</p>

問 2 「偶数のフィボナッチ数」

フィボナッチ数列の項は前の2つの項の和である. 最初の2項を 1, 2 とすれば, 最初の10項は以下の通りである.

1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ...

数列の項の値が400万以下のとき, 値が偶数の項の総和を求めよ.
</div>
</html>

```rust,editable
struct TripleBox {
    i: u64,
    j: u64,
    k: u64,
}

impl TripleBox {
    fn shift(&mut self) {
        self.i = self.j + self.k;
        self.j = self.k + self.i;
        self.k = self.i + self.j;
    }
}

fn main() {
    let mut sum = 0;
    let mut tb = TripleBox { i: 0, j: 1, k: 1 };
    while tb.i <= 4_000_000 {
        sum += tb.i;
        tb.shift()
    }
    println!("{}", sum);
    assert_eq!(sum, 4613732)
}
```
---
```rust,editable
struct LuckyClover {
    a: u64,
    b: u64,
    c: u64,
    d: u64,
}

impl LuckyClover {
    fn multiply(&mut self, other: &LuckyClover) {
        let a = self.a * other.a + self.b * other.c;
        let b = self.a * other.b + self.b * other.d;
        let c = self.c * other.a + self.d * other.c;
        let d = self.c * other.b + self.d * other.d;
        self.a = a;
        self.b = b;
        self.c = c;
        self.d = d;
    }
    fn identity_matrix() -> LuckyClover {
        LuckyClover {
            a: 1,
            b: 0,
            c: 0,
            d: 1,
        }
    }
}

fn main() {
    let multiplier = LuckyClover {
        a: 1,
        b: 1,
        c: 1,
        d: 0,
    };
    let cubed = {
        let mut i = LuckyClover::identity_matrix();
        i.multiply(&multiplier);
        i.multiply(&multiplier);
        i.multiply(&multiplier);
        std::mem::drop(multiplier);
        i
    };
    let mut sum = 0;
    let mut fibmatrix = LuckyClover::identity_matrix();
    while fibmatrix.b <= 4_000_000 {
        sum += fibmatrix.b;
        fibmatrix.multiply(&cubed);
    }
    println!("{}", sum);
    assert_eq!(sum, 4613732)
}
```

<html><iframe frameborder="0" width="750" height="750" src="https://play.rust-lang.org/?version=stable&mode=debug&edition=2018&code=use%20std%3A%3Atime%3A%3AInstant%3B%0A%0Afn%20main()%20%7B%0A%20%20%20%20%2F%2F%20warm%20up%0A%20%20%20%20assert_eq!(th_fib_matrix(1)%2C%201)%3B%0A%20%20%20%20assert_eq!(th_fib_matrix(2)%2C%201)%3B%0A%20%20%20%20assert_eq!(th_fib_matrix(3)%2C%202)%3B%0A%20%20%20%20assert_eq!(th_fib_matrix(4)%2C%203)%3B%0A%20%20%20%20assert_eq!(th_fib_matrix(5)%2C%205)%3B%0A%20%20%20%20assert_eq!(th_fib_matrix(6)%2C%208)%3B%0A%0A%20%20%20%20assert_eq!(th_fib_linear(1)%2C%201)%3B%0A%20%20%20%20assert_eq!(th_fib_linear(2)%2C%201)%3B%0A%20%20%20%20assert_eq!(th_fib_linear(3)%2C%202)%3B%0A%20%20%20%20assert_eq!(th_fib_linear(4)%2C%203)%3B%0A%20%20%20%20assert_eq!(th_fib_linear(5)%2C%205)%3B%0A%20%20%20%20assert_eq!(th_fib_linear(6)%2C%208)%3B%0A%0A%20%20%20%20%2F%2F%2088%20ns%20(Intel%20i7%203632QM)%0A%20%20%20%20let%20start_matrix%20%3D%20Instant%3A%3Anow()%3B%0A%20%20%20%20assert_eq!(th_fib_matrix(185)%2C%20205697230343233228174223751303346572685)%3B%0A%20%20%20%20let%20duration_matrix%20%3D%20start_matrix.elapsed()%3B%0A%0A%20%20%20%20%2F%2F%20133%20ns%20(Intel%20i7%203632QM)%0A%20%20%20%20let%20start_linear%20%3D%20Instant%3A%3Anow()%3B%0A%20%20%20%20assert_eq!(th_fib_linear(185)%2C%20205697230343233228174223751303346572685)%3B%0A%20%20%20%20let%20duration_linear%20%3D%20start_linear.elapsed()%3B%0A%20%20%20%20%0A%20%20%20%20println!(%0A%20%20%20%20%20%20%20%20%22Time%20elapsed%20in%20th_fib_matrix()%20%7B%3A%3F%7D%20and%20th_fib_linear()%20%7B%3A%3F%7D%22%2C%0A%20%20%20%20%20%20%20%20duration_matrix%2C%20duration_linear%0A%20%20%20%20)%3B%0A%7D%0A%0Afn%20th_fib_matrix(mut%20th%3A%20u8)%20-%3E%20u128%20%7B%0A%20%20%20%20assert!(th%20%3C%3D%20185%2C%20%22u128%20size%22)%3B%0A%20%20%20%20let%20mut%20result%20%3D%20LuckyClover%3A%3Aidentity_matrix()%3B%0A%20%20%20%20let%20mut%20acc%20%3D%20LuckyClover%20%7B%0A%20%20%20%20%20%20%20%20a%3A%201%2C%0A%20%20%20%20%20%20%20%20b%3A%201%2C%0A%20%20%20%20%20%20%20%20c%3A%201%2C%0A%20%20%20%20%20%20%20%20d%3A%200%2C%0A%20%20%20%20%7D%3B%0A%20%20%20%20loop%20%7B%0A%20%20%20%20%20%20%20%20if%20th%20%25%202%20%3D%3D%201%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20result.multiply(%26acc)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20th%20%3E%3E%3D%201%3B%0A%20%20%20%20%20%20%20%20if%20th%20%3D%3D%200%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20acc.square()%3B%0A%20%20%20%20%7D%0A%20%20%20%20result.b%0A%7D%0A%0Afn%20th_fib_linear(th%3A%20u8)%20-%3E%20u128%20%7B%0A%20%20%20%20assert!(th%20%3C%3D%20185%2C%20%22u128%20size%22)%3B%0A%20%20%20%20let%20mut%20triple%20%3D%20%5B0u128%2C%201%2C%201%5D%3B%0A%20%20%20%20for%20_%20in%200..th%20%2F%203%20%7B%0A%20%20%20%20%20%20%20%20shift(%26mut%20triple)%3B%0A%20%20%20%20%7D%0A%20%20%20%20triple%5B(th%20%25%203)%20as%20usize%5D%0A%7D%0A%0Astruct%20LuckyClover%20%7B%0A%20%20%20%20a%3A%20u128%2C%0A%20%20%20%20b%3A%20u128%2C%0A%20%20%20%20c%3A%20u128%2C%0A%20%20%20%20d%3A%20u128%2C%0A%7D%0A%0Aimpl%20LuckyClover%20%7B%0A%20%20%20%20fn%20multiply(%26mut%20self%2C%20other%3A%20%26LuckyClover)%20%7B%0A%20%20%20%20%20%20%20%20let%20a%20%3D%20self.a%20*%20other.a%20%2B%20self.b%20*%20other.c%3B%0A%20%20%20%20%20%20%20%20let%20b%20%3D%20self.a%20*%20other.b%20%2B%20self.b%20*%20other.d%3B%0A%20%20%20%20%20%20%20%20let%20c%20%3D%20self.c%20*%20other.a%20%2B%20self.d%20*%20other.c%3B%0A%20%20%20%20%20%20%20%20let%20d%20%3D%20self.c%20*%20other.b%20%2B%20self.d%20*%20other.d%3B%0A%20%20%20%20%20%20%20%20self.a%20%3D%20a%3B%0A%20%20%20%20%20%20%20%20self.b%20%3D%20b%3B%0A%20%20%20%20%20%20%20%20self.c%20%3D%20c%3B%0A%20%20%20%20%20%20%20%20self.d%20%3D%20d%3B%0A%20%20%20%20%7D%0A%20%20%20%20fn%20square(%26mut%20self)%20%7B%0A%20%20%20%20%20%20%20%20let%20a%20%3D%20self.a%20*%20self.a%20%2B%20self.b%20*%20self.c%3B%0A%20%20%20%20%20%20%20%20let%20b%20%3D%20self.a%20*%20self.b%20%2B%20self.b%20*%20self.d%3B%0A%20%20%20%20%20%20%20%20let%20c%20%3D%20self.c%20*%20self.a%20%2B%20self.d%20*%20self.c%3B%0A%20%20%20%20%20%20%20%20let%20d%20%3D%20self.c%20*%20self.b%20%2B%20self.d%20*%20self.d%3B%0A%20%20%20%20%20%20%20%20self.a%20%3D%20a%3B%0A%20%20%20%20%20%20%20%20self.b%20%3D%20b%3B%0A%20%20%20%20%20%20%20%20self.c%20%3D%20c%3B%0A%20%20%20%20%20%20%20%20self.d%20%3D%20d%3B%0A%20%20%20%20%7D%0A%20%20%20%20fn%20identity_matrix()%20-%3E%20LuckyClover%20%7B%0A%20%20%20%20%20%20%20%20LuckyClover%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20a%3A%201%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20b%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20c%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20d%3A%201%2C%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%0A%0Afn%20shift(triple%3A%20%26mut%20%5Bu128%3B%203%5D)%20%7B%0A%20%20%20%20triple%5B0%5D%20%3D%20triple%5B1%5D%20%2B%20triple%5B2%5D%3B%0A%20%20%20%20triple%5B1%5D%20%3D%20triple%5B2%5D%20%2B%20triple%5B0%5D%3B%0A%20%20%20%20triple%5B2%5D%20%3D%20triple%5B0%5D%20%2B%20triple%5B1%5D%3B%0A%7D%0A"></iframe></html>

- [Binary Exponentiation - CP-Algorithms](https://cp-algorithms.com/algebra/binary-exp.html#toc-tgt-1)

<html><center><iframe width="560" height="315" src="https://www.youtube.com/embed/L-Wzglnm4dM" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></center></html>
